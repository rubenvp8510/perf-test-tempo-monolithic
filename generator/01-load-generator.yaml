apiVersion: batch/v1
kind: Job
metadata:
  name: generate-traces
  namespace: tempo-perf-test
spec:
  completions: 50
  parallelism: 50
  template:
    spec:
      nodeSelector:
        node-role.kubernetes.io/worker: ""
      containers:
        - name: loadgen
          image: ghcr.io/honeycombio/loadgen/loadgen:latest
          args:
            - --dataset=loadtest
            - --tps=20000
            - --depth=3
            - --nspans=70
            - --runtime=15m
            - --ramptime=1s
            - --tracecount=0
            - --protocol=grpc
            - --sender=otel
            - --host=tempo-simplest:4317
            - --loglevel=debug
            - --insecure
      restartPolicy: Never
  backoffLimit: 4