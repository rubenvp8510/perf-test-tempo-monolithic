# Performance Test Load Configurations
# 
# Each load defines a different trace generation rate in MB/sec.
# The test will run each load for the specified duration.

# Default test duration for each load (can be overridden via CLI)
testDuration: "30m"

# Namespace where tests will run
namespace: "tempo-perf-test"

# Tempo endpoint configuration
tempo:
  host: "tempo-simplest"
  grpcPort: 4317
  jaegerUIPort: 16686

# Estimation config for TPS calculation
# Used to convert MB/s to TPS for the loadgen tool
# TPS = (mb_per_sec * 1024 * 1024) / (weighted_avg_spans * estimatedBytesPerSpan)
estimatedBytesPerSpan: 800

# Service configurations for multi-service trace generation
# Each service has different trace complexity (depth/spans) and receives
# a weighted portion of the total load
# - name: Service name (used as dataset in loadgen)
# - depth: Depth of the trace tree for this service
# - nspans: Number of spans per trace for this service
# - weight: Percentage of total load allocated to this service (must sum to 100)
services:
  - name: "frontend"
    depth: 3
    nspans: 8
    weight: 30
  - name: "api-gateway"
    depth: 5
    nspans: 15
    weight: 25
  - name: "order-service"
    depth: 8
    nspans: 35
    weight: 20
  - name: "payment-service"
    depth: 4
    nspans: 12
    weight: 10
  - name: "inventory-service"
    depth: 6
    nspans: 25
    weight: 15

# Load configurations
# - name: Human-readable name for the load (used in reports)
# - mb_per_sec: Target ingestion rate in megabytes per second
# - parallelism: Number of parallel load generator pods per service
loads:
  - name: "low"
    description: "Low load - baseline test"
    mb_per_sec: 0.7
    parallelism: 1

  - name: "medium"
    description: "Medium load - typical production"
    mb_per_sec: 2.0
    parallelism: 2

  - name: "high"
    description: "High load - stress test"
    mb_per_sec: 4.0
    parallelism: 2

  - name: "very-high"
    description: "Very high load - peak capacity test"
    mb_per_sec: 7.0
    parallelism: 3

# Query generator configuration
queryGenerator:
  image: "quay.io/rvargasp/query-load-generator:latest"
  delay: "5s"
  concurrentQueries: 1
